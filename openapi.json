{"openapi":"3.1.0","info":{"title":"CLI Bridge API","version":"0.4.0","description":"Universal CLI Streaming Gateway for AI Coding Assistants. Provides HTTP and WebSocket APIs for interacting with Claude Code agents.","contact":{"name":"CLI Bridge Support"},"license":{"name":"MIT"}},"servers":[{"url":"http://172.20.0.2:3100","description":"QNAP Container (Production)"},{"url":"http://localhost:3100","description":"Local Development"}],"tags":[{"name":"Status","description":"Health and metrics endpoints"},{"name":"Configuration","description":"Server configuration"},{"name":"Agents","description":"Agent lifecycle management"},{"name":"Projects","description":"Project discovery and Git operations"},{"name":"Sessions","description":"Session management and history"},{"name":"Messages","description":"Message retrieval and pagination"},{"name":"Files","description":"File browsing within projects"},{"name":"Search","description":"Full-text search across sessions"},{"name":"Permissions","description":"Tool permission management"},{"name":"Images","description":"Image upload and management"},{"name":"Push","description":"Push notification management"}],"components":{"schemas":{"HealthResponse":{"type":"object","properties":{"status":{"type":"string","enum":["ok"],"description":"Server status","example":"ok"},"agents":{"type":"integer","description":"Active agent count","example":2},"uptime":{"type":"integer","description":"Seconds since server start","example":3600},"version":{"type":"string","description":"Server version from deno.json","example":"0.3.8"}},"required":["status","agents","uptime","version"]},"MetricsResponse":{"type":"object","properties":{"uptime":{"type":"integer","description":"Seconds since server start","example":3600},"version":{"type":"string","description":"Server version","example":"0.3.8"},"agents":{"type":"integer","description":"Active agent count","example":2}},"required":["uptime","version","agents"]},"Model":{"type":"object","properties":{"id":{"type":"string","description":"Model identifier","example":"claude-sonnet-4-20250514"},"contextWindow":{"type":"integer","description":"Context window size in tokens","example":200000}},"required":["id","contextWindow"]},"ModelsListResponse":{"type":"object","properties":{"models":{"type":"array","items":{"$ref":"#/components/schemas/Model"},"description":"Available Claude models"}},"required":["models"]},"ThinkingMode":{"type":"object","properties":{"id":{"type":"string","description":"Mode identifier","example":"think"},"name":{"type":"string","description":"Human-readable name","example":"Think"},"description":{"type":"string","description":"Mode description","example":"Standard extended thinking"},"phrase":{"type":"string","description":"Phrase appended to message","example":"Think step by step."},"budget":{"type":"integer","description":"Relative thinking budget (higher = more thinking)","example":10000}},"required":["id","name","description","phrase","budget"]},"ThinkingModesListResponse":{"type":"object","properties":{"modes":{"type":"array","items":{"$ref":"#/components/schemas/ThinkingMode"},"description":"Available thinking modes"}},"required":["modes"]},"GitStatus":{"type":"object","properties":{"branch":{"type":"string","description":"Current branch name","example":"main"},"isClean":{"type":"boolean","description":"No uncommitted changes","example":true},"uncommittedCount":{"type":"integer","description":"Number of changed files","example":0},"ahead":{"type":"integer","description":"Commits ahead of remote","example":0},"behind":{"type":"integer","description":"Commits behind remote","example":0},"hasUntracked":{"type":"boolean","description":"Has untracked files"},"hasStaged":{"type":"boolean","description":"Has staged changes"},"remote":{"type":"string","description":"Remote name","example":"origin"},"trackingBranch":{"type":"string","description":"Tracking branch","example":"origin/main"}},"required":["branch","isClean"],"description":"Git repository status"},"Project":{"type":"object","properties":{"path":{"type":"string","description":"Absolute path to project","example":"/Users/dev/my-project"},"name":{"type":"string","description":"Directory name","example":"my-project"},"lastUsed":{"type":"string","format":"date-time","description":"Last activity timestamp"},"sessionCount":{"type":"integer","description":"Number of sessions","example":5},"git":{"$ref":"#/components/schemas/GitStatus"}},"required":["path","name"]},"ProjectListResponse":{"type":"object","properties":{"projects":{"type":"array","items":{"$ref":"#/components/schemas/Project"},"description":"List of discovered projects"}},"required":["projects"]},"Error":{"type":"object","properties":{"error":{"type":"string","description":"Error message","example":"Session not found"},"code":{"type":"string","description":"Error code","example":"NOT_FOUND"},"details":{"type":"object","additionalProperties":{"nullable":true},"description":"Additional error details"}},"required":["error"]},"SessionMetadata":{"type":"object","properties":{"id":{"type":"string","format":"uuid","description":"Claude's native UUID","example":"550e8400-e29b-41d4-a716-446655440000"},"projectPath":{"type":"string","description":"Absolute project path","example":"/Users/dev/my-project"},"source":{"type":"string","enum":["user","agent","helper"],"description":"Who created this session","example":"user"},"createdAt":{"type":"string","format":"date-time","description":"When session was created"},"lastActivityAt":{"type":"string","format":"date-time","description":"Last message timestamp"},"messageCount":{"type":"integer","description":"Number of messages","example":42},"lastUserMessage":{"type":"string","description":"Last user message (truncated to 200 chars)"},"lastAssistantMessage":{"type":"string","description":"Last assistant message (truncated to 200 chars)"},"title":{"type":"string","description":"First user message or AI-generated title"},"customTitle":{"type":"string","nullable":true,"description":"User-assigned custom title (overrides title)"},"model":{"type":"string","description":"Claude model used","example":"claude-sonnet-4-20250514"},"archivedAt":{"type":"string","format":"date-time","description":"When archived (soft delete)"},"parentSessionId":{"type":"string","format":"uuid","description":"Parent session UUID for lineage tracking"}},"required":["id","projectPath","source","lastActivityAt","messageCount"]},"RecentSessionsResponse":{"type":"object","properties":{"sessions":{"type":"array","items":{"$ref":"#/components/schemas/SessionMetadata"},"description":"Recent sessions across all projects"}},"required":["sessions"]},"SessionListResult":{"type":"object","properties":{"sessions":{"type":"array","items":{"$ref":"#/components/schemas/SessionMetadata"},"description":"List of sessions"},"total":{"type":"integer","description":"Total sessions matching filter","example":42},"hasMore":{"type":"boolean","description":"Whether more sessions exist","example":true}},"required":["sessions","total","hasMore"]},"SessionCountResult":{"type":"object","properties":{"total":{"type":"integer","description":"Total session count"},"count":{"type":"integer","description":"Count for specific source"},"source":{"type":"string","description":"Source filter applied"},"user":{"type":"integer","description":"User session count"},"agent":{"type":"integer","description":"Agent session count"},"helper":{"type":"integer","description":"Helper session count"}}},"SearchSnippet":{"type":"object","properties":{"type":{"type":"string","description":"Message type (user, assistant, etc.)"},"text":{"type":"string","description":"Snippet text with context"},"matchStart":{"type":"integer","description":"Character offset of match start"},"matchLength":{"type":"integer","description":"Length of match"}},"required":["type","text","matchStart","matchLength"]},"SearchResult":{"type":"object","properties":{"sessionId":{"type":"string","description":"Matched session ID"},"projectPath":{"type":"string","description":"Project path"},"score":{"type":"number","description":"Relevance score"},"snippets":{"type":"array","items":{"$ref":"#/components/schemas/SearchSnippet"},"description":"Matched text snippets"},"timestamp":{"type":"string","description":"Session timestamp"}},"required":["sessionId","projectPath","score","snippets","timestamp"]},"SearchResponse":{"type":"object","properties":{"query":{"type":"string","description":"Search query"},"results":{"type":"array","items":{"$ref":"#/components/schemas/SearchResult"},"description":"Search results"},"total":{"type":"integer","description":"Total matches"},"hasMore":{"type":"boolean","description":"More results available"}},"required":["results","total","hasMore"]},"PaginatedMessage":{"type":"object","properties":{"id":{"type":"string","description":"Message ID"},"timestamp":{"type":"string","description":"Message timestamp"},"message":{"type":"object","additionalProperties":{"nullable":true},"description":"Message content with type and content fields"},"rawContent":{"type":"array","items":{"nullable":true},"description":"Structured content blocks"}},"required":["id","timestamp","message"]},"IntegrityInfo":{"type":"object","properties":{"totalLines":{"type":"integer","description":"Total lines processed from history file"},"validLines":{"type":"integer","description":"Lines that parsed successfully"},"corruptedLines":{"type":"integer","description":"Lines that failed to parse"},"corruptedSamples":{"type":"array","items":{"type":"string"},"description":"Sample of corrupted line content"}},"required":["totalLines","validLines","corruptedLines","corruptedSamples"],"description":"Data integrity information"},"PaginationError":{"type":"object","properties":{"code":{"type":"string","enum":["CURSOR_NOT_FOUND","CURSOR_EXPIRED","INVALID_PARAMS"],"description":"Error code"},"cursorId":{"type":"string","description":"The cursor ID that caused the error"},"maxAge":{"type":"integer","description":"Maximum cursor age in seconds"},"message":{"type":"string","description":"Error message"}},"required":["code"],"description":"Pagination error details"},"GetMessagesResponse":{"type":"object","properties":{"apiVersion":{"type":"string","enum":["2.0"],"description":"API version"},"messages":{"type":"array","items":{"$ref":"#/components/schemas/PaginatedMessage"},"description":"Paginated messages"},"pagination":{"type":"object","properties":{"total":{"type":"integer"},"limit":{"type":"integer"},"offset":{"type":"integer"},"hasMore":{"type":"boolean"},"nextCursor":{"type":"string"},"prevCursor":{"type":"string"}},"required":["total","limit","offset","hasMore"],"description":"Pagination info"},"filters":{"type":"object","properties":{"types":{"type":"array","items":{"type":"string"}},"order":{"type":"string","enum":["asc","desc"]},"denormalize":{"type":"boolean"}},"required":["types","order","denormalize"],"description":"Applied filters"},"integrity":{"$ref":"#/components/schemas/IntegrityInfo"},"error":{"$ref":"#/components/schemas/PaginationError"}},"required":["apiVersion","messages","pagination","filters"]},"SessionUpdateBody":{"type":"object","properties":{"title":{"type":"string","nullable":true,"description":"Custom title for the session"},"customTitle":{"type":"string","nullable":true,"description":"Legacy: Custom title (prefer 'title')"}}},"DeleteResult":{"type":"object","properties":{"deleted":{"anyOf":[{"type":"boolean"},{"type":"integer"}],"description":"True if deleted, or count of deleted sessions"}},"required":["deleted"]},"BulkOperationResult":{"type":"object","properties":{"success":{"type":"array","items":{"type":"string"},"description":"Successfully processed session IDs"},"failed":{"type":"array","items":{"type":"object","properties":{"sessionId":{"type":"string"},"error":{"type":"string"}},"required":["sessionId","error"]},"description":"Failed operations with error details"}},"required":["success","failed"]},"BulkOperationRequest":{"type":"object","properties":{"sessionIds":{"type":"array","items":{"type":"string","format":"uuid"},"minItems":1,"maxItems":100,"description":"Session IDs to operate on (1-100)"},"operation":{"type":"object","properties":{"action":{"type":"string","enum":["archive","unarchive","delete","update"],"description":"Operation to perform"},"customTitle":{"type":"string","nullable":true,"description":"Title for update operations"}},"required":["action"],"description":"Operation to perform"}},"required":["sessionIds","operation"]},"AgentCreated":{"type":"object","properties":{"id":{"type":"string","description":"Agent ID","example":"agent_abc123"},"projectPath":{"type":"string","description":"Project path"},"sessionId":{"type":"string","description":"Session ID"},"model":{"type":"string","description":"Model ID"},"state":{"type":"string","enum":["starting","idle","running","waiting_permission","waiting_input","recovering","stopped"],"description":"Agent state"},"isHelper":{"type":"boolean","description":"Is helper agent"},"createdAt":{"type":"string","format":"date-time","description":"Creation timestamp"}},"required":["id","projectPath","sessionId","model","state","isHelper","createdAt"]},"AgentCreateBody":{"type":"object","properties":{"projectPath":{"type":"string","minLength":1,"description":"Absolute path to the project directory","example":"/Users/dev/my-project"},"sessionId":{"type":"string","format":"uuid","description":"Session ID to resume (optional)"},"model":{"type":"string","description":"Model alias (opus, sonnet, haiku)","example":"sonnet"},"helper":{"type":"boolean","description":"Create as helper agent (non-interactive)"}},"required":["projectPath"]},"AgentListItem":{"type":"object","properties":{"id":{"type":"string","description":"Agent ID"},"projectPath":{"type":"string","description":"Project path"},"sessionId":{"type":"string","description":"Session ID"},"model":{"type":"string","description":"Model ID"},"state":{"type":"string","enum":["starting","idle","running","waiting_permission","waiting_input","recovering","stopped"],"description":"Agent state"},"isHelper":{"type":"boolean","description":"Is helper agent"},"createdAt":{"type":"string","format":"date-time","description":"Creation timestamp"},"lastActivityAt":{"type":"string","format":"date-time","description":"Last activity timestamp"},"hasActiveConnection":{"type":"boolean","description":"Has active WebSocket connection"}},"required":["id","projectPath","sessionId","model","state","isHelper","createdAt","lastActivityAt","hasActiveConnection"]},"AgentListResponse":{"type":"object","properties":{"agents":{"type":"array","items":{"$ref":"#/components/schemas/AgentListItem"},"description":"List of agents"}},"required":["agents"]},"AgentDetail":{"type":"object","properties":{"id":{"type":"string","description":"Agent ID"},"projectPath":{"type":"string","description":"Project path"},"sessionId":{"type":"string","description":"Session ID"},"model":{"type":"string","description":"Model ID"},"state":{"type":"string","enum":["starting","idle","running","waiting_permission","waiting_input","recovering","stopped"],"description":"Agent state"},"permissionMode":{"type":"string","enum":["default","acceptEdits","bypassPermissions"],"description":"Permission mode"},"isHelper":{"type":"boolean","description":"Is helper agent"},"createdAt":{"type":"string","format":"date-time","description":"Creation timestamp"},"lastActivityAt":{"type":"string","format":"date-time","description":"Last activity timestamp"},"hasPendingPermission":{"type":"boolean","description":"Waiting for permission approval"},"hasPendingQuestion":{"type":"boolean","description":"Waiting for question answer"},"hasQueuedInput":{"type":"boolean","description":"Has queued user input"}},"required":["id","projectPath","sessionId","model","state","permissionMode","isHelper","createdAt","lastActivityAt","hasPendingPermission","hasPendingQuestion","hasQueuedInput"]},"AgentDeleteResult":{"type":"object","properties":{"deleted":{"type":"boolean","description":"Whether the agent was deleted"}},"required":["deleted"]}},"parameters":{}},"paths":{"/health":{"get":{"tags":["Status"],"summary":"Health check","description":"Returns server status, active agent count, uptime, and version.","responses":{"200":{"description":"Server is healthy","content":{"application/json":{"schema":{"$ref":"#/components/schemas/HealthResponse"}}}}}}},"/metrics":{"get":{"tags":["Status"],"summary":"Server metrics","description":"Returns basic server metrics including uptime and agent count.","responses":{"200":{"description":"Server metrics","content":{"application/json":{"schema":{"$ref":"#/components/schemas/MetricsResponse"}}}}}}},"/config/models":{"get":{"tags":["Configuration"],"summary":"List available models","description":"Returns a list of available Claude models with their context window sizes.","responses":{"200":{"description":"Available models","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ModelsListResponse"}}}}}}},"/config/thinking-modes":{"get":{"tags":["Configuration"],"summary":"List thinking modes","description":"Returns available thinking modes ordered by increasing thinking budget.","responses":{"200":{"description":"Available thinking modes","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ThinkingModesListResponse"}}}}}}},"/projects":{"get":{"tags":["Projects"],"summary":"List all projects","description":"Returns a list of all discovered projects with their Git status and session counts.","responses":{"200":{"description":"List of projects","content":{"application/json":{"schema":{"$ref":"#/components/schemas/ProjectListResponse"}}}}}}},"/projects/{encodedPath}":{"get":{"tags":["Projects"],"summary":"Get project details","description":"Returns details for a specific project by its encoded path.","parameters":[{"schema":{"type":"string","minLength":1,"description":"URL-encoded absolute project path","example":"test-my-project"},"required":true,"name":"encodedPath","in":"path"}],"responses":{"200":{"description":"Project details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Project"}}}},"404":{"description":"Project not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/sessions/recent":{"get":{"tags":["Sessions"],"summary":"List recent sessions","description":"Returns recent sessions across all projects, sorted by last activity.","parameters":[{"schema":{"type":"integer","minimum":1,"maximum":50,"default":10,"description":"Maximum sessions to return (max 50)","example":10},"required":false,"name":"limit","in":"query"},{"schema":{"type":"string","description":"Filter by source","example":"user"},"required":false,"name":"source","in":"query"}],"responses":{"200":{"description":"Recent sessions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/RecentSessionsResponse"}}}}}}},"/projects/{encodedPath}/sessions":{"get":{"tags":["Sessions"],"summary":"List project sessions","description":"Returns paginated sessions for a project with optional filtering.","parameters":[{"schema":{"type":"string","minLength":1,"description":"URL-encoded absolute project path","example":"test-my-project"},"required":true,"name":"encodedPath","in":"path"},{"schema":{"type":"integer","minimum":1,"maximum":100,"default":50,"description":"Maximum sessions to return","example":50},"required":false,"name":"limit","in":"query"},{"schema":{"type":"integer","nullable":true,"minimum":0,"default":0,"description":"Sessions to skip","example":0},"required":false,"name":"offset","in":"query"},{"schema":{"type":"string","description":"Filter by source (user, agent, helper, all, or comma-separated)","example":"user"},"required":false,"name":"source","in":"query"},{"schema":{"type":"boolean","nullable":true,"default":false,"description":"Include archived sessions"},"required":false,"name":"includeArchived","in":"query"},{"schema":{"type":"boolean","nullable":true,"default":false,"description":"Only return archived sessions"},"required":false,"name":"archivedOnly","in":"query"},{"schema":{"type":"string","format":"uuid","description":"Filter by parent session"},"required":false,"name":"parentSessionId","in":"query"}],"responses":{"200":{"description":"Session list","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionListResult"}}}}}},"delete":{"tags":["Sessions"],"summary":"Bulk delete sessions","description":"Delete multiple sessions by filter: older_than (days), source, agent_older_than (hours), or empty.","parameters":[{"schema":{"type":"string","minLength":1,"description":"URL-encoded absolute project path","example":"test-my-project"},"required":true,"name":"encodedPath","in":"path"},{"schema":{"type":"string","enum":["older_than","source","agent_older_than","empty"],"description":"Delete filter type"},"required":true,"name":"filter","in":"query"},{"schema":{"type":"integer","nullable":true,"description":"Days for older_than filter"},"required":false,"name":"days","in":"query"},{"schema":{"type":"integer","nullable":true,"description":"Hours for agent_older_than filter"},"required":false,"name":"hours","in":"query"},{"schema":{"type":"string","enum":["user","agent","helper"],"description":"Source for source filter"},"required":false,"name":"source","in":"query"}],"responses":{"200":{"description":"Sessions deleted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteResult"}}}},"400":{"description":"Invalid filter parameters","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/projects/{encodedPath}/sessions/count":{"get":{"tags":["Sessions"],"summary":"Count sessions","description":"Returns session count by source. Much faster than fetching full list.","parameters":[{"schema":{"type":"string","minLength":1,"description":"URL-encoded absolute project path","example":"test-my-project"},"required":true,"name":"encodedPath","in":"path"},{"schema":{"type":"string","description":"Filter by source"},"required":false,"name":"source","in":"query"}],"responses":{"200":{"description":"Session counts","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionCountResult"}}}}}}},"/projects/{encodedPath}/sessions/search":{"get":{"tags":["Sessions","Search"],"summary":"Search sessions in project","description":"Full-text search within a specific project's sessions.","parameters":[{"schema":{"type":"string","minLength":1,"description":"URL-encoded absolute project path","example":"test-my-project"},"required":true,"name":"encodedPath","in":"path"},{"schema":{"type":"string","minLength":1,"description":"Search query","example":"implement feature"},"required":true,"name":"q","in":"query"},{"schema":{"type":"integer","minimum":1,"maximum":100,"description":"Maximum results"},"required":false,"name":"limit","in":"query"},{"schema":{"type":"integer","nullable":true,"minimum":0,"description":"Results to skip"},"required":false,"name":"offset","in":"query"}],"responses":{"200":{"description":"Search results","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SearchResponse"}}}},"400":{"description":"Invalid parameters","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/projects/{encodedPath}/sessions/{sessionId}":{"get":{"tags":["Sessions"],"summary":"Get session details","description":"Returns metadata for a specific session.","parameters":[{"schema":{"type":"string","minLength":1,"description":"URL-encoded absolute project path","example":"test-my-project"},"required":true,"name":"encodedPath","in":"path"},{"schema":{"type":"string","minLength":1,"description":"Session UUID","example":"550e8400-e29b-41d4-a716-446655440000"},"required":true,"name":"sessionId","in":"path"}],"responses":{"200":{"description":"Session details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionMetadata"}}}},"404":{"description":"Session not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}},"put":{"tags":["Sessions"],"summary":"Update session","description":"Update session properties like custom title.","parameters":[{"schema":{"type":"string","minLength":1,"description":"URL-encoded absolute project path","example":"test-my-project"},"required":true,"name":"encodedPath","in":"path"},{"schema":{"type":"string","minLength":1,"description":"Session UUID","example":"550e8400-e29b-41d4-a716-446655440000"},"required":true,"name":"sessionId","in":"path"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionUpdateBody"}}}},"responses":{"200":{"description":"Updated session","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionMetadata"}}}},"400":{"description":"Invalid request body","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Session not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}},"delete":{"tags":["Sessions"],"summary":"Delete session","description":"Permanently delete a session and its history.","parameters":[{"schema":{"type":"string","minLength":1,"description":"URL-encoded absolute project path","example":"test-my-project"},"required":true,"name":"encodedPath","in":"path"},{"schema":{"type":"string","minLength":1,"description":"Session UUID","example":"550e8400-e29b-41d4-a716-446655440000"},"required":true,"name":"sessionId","in":"path"}],"responses":{"200":{"description":"Session deleted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/DeleteResult"}}}},"404":{"description":"Session not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/projects/{encodedPath}/sessions/{sessionId}/children":{"get":{"tags":["Sessions"],"summary":"Get child sessions","description":"Returns sessions that have this session as their parent (subagent sessions).","parameters":[{"schema":{"type":"string","minLength":1,"description":"URL-encoded absolute project path","example":"test-my-project"},"required":true,"name":"encodedPath","in":"path"},{"schema":{"type":"string","minLength":1,"description":"Session UUID","example":"550e8400-e29b-41d4-a716-446655440000"},"required":true,"name":"sessionId","in":"path"},{"schema":{"type":"integer","minimum":1,"maximum":100,"default":50},"required":false,"name":"limit","in":"query"},{"schema":{"type":"integer","nullable":true,"minimum":0,"default":0},"required":false,"name":"offset","in":"query"}],"responses":{"200":{"description":"Child sessions","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionListResult"}}}}}}},"/projects/{encodedPath}/sessions/{sessionId}/export":{"get":{"tags":["Sessions"],"summary":"Export session","description":"Exports session content in markdown or JSON format.","parameters":[{"schema":{"type":"string","minLength":1,"description":"URL-encoded absolute project path","example":"test-my-project"},"required":true,"name":"encodedPath","in":"path"},{"schema":{"type":"string","minLength":1,"description":"Session UUID","example":"550e8400-e29b-41d4-a716-446655440000"},"required":true,"name":"sessionId","in":"path"},{"schema":{"type":"string","default":"markdown","description":"Export format (markdown or json)","example":"markdown"},"required":false,"name":"format","in":"query"},{"schema":{"anyOf":[{"type":"boolean"},{"type":"string"}],"default":false,"description":"Exclude thinking content"},"required":false,"name":"excludeThinking","in":"query"},{"schema":{"anyOf":[{"type":"boolean"},{"type":"string"}],"default":false,"description":"Include structured content blocks"},"required":false,"name":"includeStructuredContent","in":"query"}],"responses":{"200":{"description":"Exported session content","content":{"text/markdown":{"schema":{"type":"string"}},"application/json":{"schema":{"nullable":true}}}},"400":{"description":"Invalid format","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Session not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/projects/{encodedPath}/sessions/{sessionId}/messages":{"get":{"tags":["Sessions","Messages"],"summary":"Get paginated messages","description":"Returns paginated messages with cursor or offset-based pagination. Default order is newest-first.","parameters":[{"schema":{"type":"string","minLength":1,"description":"URL-encoded absolute project path","example":"test-my-project"},"required":true,"name":"encodedPath","in":"path"},{"schema":{"type":"string","minLength":1,"description":"Session UUID","example":"550e8400-e29b-41d4-a716-446655440000"},"required":true,"name":"sessionId","in":"path"},{"schema":{"type":"string","format":"uuid","description":"Cursor: fetch messages before this ID"},"required":false,"name":"before","in":"query"},{"schema":{"type":"string","format":"uuid","description":"Cursor: fetch messages after this ID"},"required":false,"name":"after","in":"query"},{"schema":{"type":"integer","minimum":1,"maximum":100,"default":25,"description":"Maximum messages to return","example":25},"required":false,"name":"limit","in":"query"},{"schema":{"type":"integer","nullable":true,"minimum":0,"description":"Messages to skip (cannot use with cursors)"},"required":false,"name":"offset","in":"query"},{"schema":{"type":"string","description":"Comma-separated message types filter","example":"user,assistant"},"required":false,"name":"types","in":"query"},{"schema":{"type":"string","enum":["asc","desc"],"default":"desc","description":"Sort order (desc = newest first)"},"required":false,"name":"order","in":"query"},{"schema":{"anyOf":[{"type":"boolean"},{"type":"string"}],"default":true,"description":"Merge tool_use and tool_result into assistant messages"},"required":false,"name":"denormalize","in":"query"},{"schema":{"anyOf":[{"type":"boolean"},{"type":"string"}],"default":false,"description":"Include structured content blocks"},"required":false,"name":"includeRawContent","in":"query"}],"responses":{"200":{"description":"Paginated messages","content":{"application/json":{"schema":{"$ref":"#/components/schemas/GetMessagesResponse"}}}},"400":{"description":"Invalid parameters","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"404":{"description":"Session not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"429":{"description":"Rate limited","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Internal error","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/projects/{encodedPath}/sessions/{sessionId}/archive":{"post":{"tags":["Sessions"],"summary":"Archive session","description":"Soft-delete a session by marking it as archived.","parameters":[{"schema":{"type":"string","minLength":1,"description":"URL-encoded absolute project path","example":"test-my-project"},"required":true,"name":"encodedPath","in":"path"},{"schema":{"type":"string","minLength":1,"description":"Session UUID","example":"550e8400-e29b-41d4-a716-446655440000"},"required":true,"name":"sessionId","in":"path"}],"responses":{"200":{"description":"Archived session","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionMetadata"}}}},"404":{"description":"Session not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/projects/{encodedPath}/sessions/{sessionId}/unarchive":{"post":{"tags":["Sessions"],"summary":"Unarchive session","description":"Restore an archived session.","parameters":[{"schema":{"type":"string","minLength":1,"description":"URL-encoded absolute project path","example":"test-my-project"},"required":true,"name":"encodedPath","in":"path"},{"schema":{"type":"string","minLength":1,"description":"Session UUID","example":"550e8400-e29b-41d4-a716-446655440000"},"required":true,"name":"sessionId","in":"path"}],"responses":{"200":{"description":"Unarchived session","content":{"application/json":{"schema":{"$ref":"#/components/schemas/SessionMetadata"}}}},"404":{"description":"Session not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/projects/{encodedPath}/sessions/bulk":{"post":{"tags":["Sessions"],"summary":"Bulk session operations","description":"Perform bulk operations (archive, unarchive, delete, update) on multiple sessions.","parameters":[{"schema":{"type":"string","minLength":1,"description":"URL-encoded absolute project path","example":"test-my-project"},"required":true,"name":"encodedPath","in":"path"}],"requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkOperationRequest"}}}},"responses":{"200":{"description":"Bulk operation result","content":{"application/json":{"schema":{"$ref":"#/components/schemas/BulkOperationResult"}}}},"400":{"description":"Invalid request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}},"/agents":{"post":{"tags":["Agents"],"summary":"Create agent","description":"Create a new Claude agent for a project.","requestBody":{"content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentCreateBody"}}}},"responses":{"201":{"description":"Agent created","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentCreated"}}}},"400":{"description":"Invalid request","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"429":{"description":"Max agents reached","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}},"500":{"description":"Failed to create agent","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}},"get":{"tags":["Agents"],"summary":"List agents","description":"List all active agents.","responses":{"200":{"description":"List of agents","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentListResponse"}}}}}}},"/agents/{agentId}":{"get":{"tags":["Agents"],"summary":"Get agent details","description":"Get detailed information about a specific agent.","parameters":[{"schema":{"type":"string","description":"Agent ID","example":"agent_abc123"},"required":true,"name":"agentId","in":"path"}],"responses":{"200":{"description":"Agent details","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentDetail"}}}},"404":{"description":"Agent not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}},"delete":{"tags":["Agents"],"summary":"Delete agent","description":"Stop and delete an agent.","parameters":[{"schema":{"type":"string","description":"Agent ID","example":"agent_abc123"},"required":true,"name":"agentId","in":"path"}],"responses":{"200":{"description":"Agent deleted","content":{"application/json":{"schema":{"$ref":"#/components/schemas/AgentDeleteResult"}}}},"404":{"description":"Agent not found","content":{"application/json":{"schema":{"$ref":"#/components/schemas/Error"}}}}}}}}}